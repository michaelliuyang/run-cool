<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Run Cool by michaelliuyang</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Run Cool</h1>
        <h2>Run Cool</h2>

        <section id="downloads">
          <a href="https://github.com/michaelliuyang/run-cool/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/michaelliuyang/run-cool/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/michaelliuyang/run-cool" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h2>
<a name="welcome-to-run-cool-server-page" class="anchor" href="#welcome-to-run-cool-server-page"><span class="octicon octicon-link"></span></a>Welcome to Run Cool server page.</h2>

<p>This page include 3 parts:</p>

<ul>
<li>Prepare Environment</li>
<li>Configuration</li>
<li>Protocol Design</li>
</ul><h3>
<a name="prepare-environment" class="anchor" href="#prepare-environment"><span class="octicon octicon-link"></span></a>Prepare Environment</h3>

<ol>
<li>Application Server

<ul>
<li>Tomcat 6.x or 7.x OR other application servers</li>
</ul>
</li>
<li>DB Server

<ul>
<li>Mysql 5.x</li>
</ul>
</li>
<li>JDBC Connection Pool

<ul>
<li>The project JDBC data source used JNDI config.</li>
<li>Proxool OR DBCP OR other ...</li>
</ul>
</li>
<li>Install Maven

<ul>
<li><a href="http://maven.apache.org">Maven Home</a></li>
</ul>
</li>
</ol><h3>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h3>

<blockquote>
<p>You can use <strong>terminal</strong> to clone code or click <strong>download button</strong> on top of this page to get code.</p>

<pre><code>$ git clone https://github.com/michaelliuyang/run-cool.git
</code></pre>

<p>Go to your download folder</p>

<pre><code>$ cd run-cool/run-cool-app
</code></pre>

<p>Run maven command</p>

<pre><code>$ mvn install
</code></pre>

<p>Get war file from project target folder and deploy your application server.</p>
</blockquote>

<h3>
<a name="protocol-design" class="anchor" href="#protocol-design"><span class="octicon octicon-link"></span></a>Protocol Design</h3>

<h4>
<a name="request" class="anchor" href="#request"><span class="octicon octicon-link"></span></a>Request</h4>

<h5>
<a name="common-part-request" class="anchor" href="#common-part-request"><span class="octicon octicon-link"></span></a>Common Part Request</h5>

<pre><code>{
    "request": {
        "protocol": "1.0", //Protocol version
        "type": "", //Request type: 1:GetArea 2:GetBattleTarget 
                      3:UploadResult 4:GetRanking
        "imei":"013354000103155", //Device code
        "userId": "", //User id
        "mobilePhone": "13811312013", //Mobile phone number
        "nickName": "michael", //Nick name
        "role": {
            "name": "magic", //Role name
            "rank": "3" //Role rank
        },
        "mounts": {
            "name": "bird", //Mounts name
            "rank": "8"  //Mounts rank
        },
        "pet": {
            "name": "peter" //Pet name
        },
        ......
    }
}
</code></pre>

<h5>
<a name="get-arena-request" class="anchor" href="#get-arena-request"><span class="octicon octicon-link"></span></a>Get Arena Request</h5>

<pre><code>{
    "request": {
        ...Common part...
        "isGetBattleInfo": "0" //0:not send 1:send  
                                 Tell server is send user battle 
                                 history list for recent 5
    }
}
</code></pre>

<h5>
<a name="get-battle-target-request" class="anchor" href="#get-battle-target-request"><span class="octicon octicon-link"></span></a>Get Battle Target Request</h5>

<pre><code>{
    "request": {
        ...Common part...
    }
}
</code></pre>

<h5>
<a name="upload-battle-result-request" class="anchor" href="#upload-battle-result-request"><span class="octicon octicon-link"></span></a>Upload Battle Result Request</h5>

<pre><code>{
    "request": {
        ...Common part...
        "arenaId": "1", //Arena id
        "battleScore": "320", //Battle score
        "result": "W", //Battle result W or L
        "isContinueWin": "0", //Is continue win 0:No 1:Yes
        "targetUserId": "bc928dfd2aa911f65580b6a3e2f5192x"
    }
}
</code></pre>

<h5>
<a name="get-ranking-request" class="anchor" href="#get-ranking-request"><span class="octicon octicon-link"></span></a>Get Ranking Request</h5>

<pre><code>{
    "request": {
        ...Common part...
    }
}
</code></pre>

<h4>
<a name="response" class="anchor" href="#response"><span class="octicon octicon-link"></span></a>Response</h4>

<h5>
<a name="common-part-response" class="anchor" href="#common-part-response"><span class="octicon octicon-link"></span></a>Common Part Response</h5>

<pre><code>{
    "response": {
        "protocol": "1.0", 
        "type": "1",
        "userId": "d2920c2eae982afd5eb40f29316e9b08",
        "returnCode": "0" //Server return code  
                            0:Success 1:illegal 2:server error
    }
}
</code></pre>

<h5>
<a name="get-arena-response" class="anchor" href="#get-arena-response"><span class="octicon octicon-link"></span></a>Get Arena Response</h5>

<pre><code>{
    "response": {
        ...common part...
        "allow": "0", //Is allow join arena  0:NO 1:YES
        "joinedCount": 0, //Joined battle count
        "props": [  //Prop info, S:SPRINT,3 R:REVIVE,3
            {
                "name": "S", 
                "limit": 3
            }, 
            {
                "name": "R", 
                "limit": 3
            }
        ], 
        "arenas": [
          {
            "arenaId": 1, //Arena id
            "type": "GOLDEN", //Arena type  GOLDEN OR DIAMOND
            "level": "ONE", //Arena level   ONE OR TWO OR THREE
            "consumeMoney": 10,  //Consume money
            "rewardMoney": 50,  //Reward money
            "rewardScore": 100, //Reward Score
            "continueWinAddPercent": 0.1 //Continue win add percent
          },
          ......
       ],
       "battleHistorys": [ // If isGetBattleInfo equal 1
        {
        "targetUser": {
          "userId": "bc928dfd2aa911f65580b6a3e2f5192q",
          "mobilePhone": "13811312031",
          "nickName": "a1",
          "roleName": "warrior",
          "roleRank": "3",
          "petName": "hh",
          "mountsName": "vv",
          "mountsRank": "1",
          "score": 56,
          "maxBattleScore": 76
        },
        "arenaId": 1,
        "result": "LOSE",
        "score": 102
      },
      ......
      ]
    }
}
</code></pre>

<h5>
<a name="get-battle-target-response" class="anchor" href="#get-battle-target-response"><span class="octicon octicon-link"></span></a>Get Battle Target Response</h5>

<pre><code>{
    "response": {
        ...Common part...
        "battleTargetUser": {
        "userId": "bc928dfd2aa911f65580b6a3e2f5192p",
        "mobilePhone": "13811312055",
        "nickName": "a3",
        "roleName": "warrior",
        "roleRank": "3",
        "petName": "zz",
        "mountsName": "hh",
        "mountsRank": "3",
        "score": 100,
        "maxBattleScore": 98
      }
    }
}
</code></pre>

<h5>
<a name="upload-battle-result-response" class="anchor" href="#upload-battle-result-response"><span class="octicon octicon-link"></span></a>Upload Battle Result Response</h5>

<pre><code>{
    "response": {
        ...Common part...
        "userRanking": 1,  //User battle score ranking
        "targetRanking": 6  //Target user battle score ranking
    }
}
</code></pre>

<h5>
<a name="get-ranking-response" class="anchor" href="#get-ranking-response"><span class="octicon octicon-link"></span></a>Get Ranking Response</h5>

<pre><code>{
    "response": {
        ...Common part...
        "scoreRankingList": [ //User score ranking
          {
          "ranking": 1,
          "userId": "bc928dfd2aa911f65580b6a3e2f5192l",
          "nickName": "a5",
          "role":{
            "name":"",
            "rank":""
          },
          "score": 200
          },
        ......
        ],
        "battleScoreRankingList": [ //User battle Score ranking
          {
            "ranking": 1,
            "userId": "bc928dfd2aa911f65580b6a3e2f5192l",
            "nickName": "a5",
            "role":{
              "name":"",
              "rank":""
            },
            "score": 120
         },
         .....
        ]
    }
}
</code></pre>
      </section>
    </div>

    
  </body>
</html>